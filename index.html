<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BINGO</title>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(to bottom, #c81d25, #006400);
      background-attachment: fixed;
      color: #fff;
      padding: 20px;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.4);
    }
    .container { max-width: 1200px; margin: 0 auto; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; font-size: 14px; background: rgba(255,255,255,0.9); color: #222; border-radius: 10px; overflow: hidden; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background: #006400; color: #fff; position: sticky; top: 0; z-index: 5; }
    tr:nth-child(even) { background: #f9f9f9; }
    .highlight { background: #ffec8b; font-weight: 700; color: #c81d25; }
    h1 { text-align: center; font-size: 2.5em; margin-top: 0; }
    .note { text-align: center; font-size: 1.1em; margin-bottom: 10px; }
    #fireworksCanvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 10; }
    .results { margin-bottom: 20px; text-align: center; position: sticky; top: 0; background: rgba(0,0,0,0.7); padding: 10px; border-radius: 10px; z-index: 6; }
    ul { list-style: none; padding: 0; margin: 0; }
    li { background: rgba(255,255,255,0.2); padding: 8px; margin: 5px auto; width: fit-content; border-radius: 6px; }
  </style>
</head>
<body>
  <canvas id="fireworksCanvas"></canvas>
  <div class="container">
    <h1>üéÑ BINGO üéÅ</h1>
    <div class="results">
      <h2>‚ú® Official 6/49 Draw Results ‚ú®</h2>
      <ul id="resultsList"></ul>
    </div>

    <table id="lottoTable">
      <thead>
        <tr>
          <th>Name</th>
          <th>#1</th>
          <th>#2</th>
          <th>#3</th>
          <th>#4</th>
          <th>#5</th>
          <th>#6</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    const players = [
{"name":"CHRIS","nums":[7,15,23,34,42,48]},
{"name":"KING","nums":[4,9,17,18,23,25]},
{"name":"KAT","nums":[2,4,13,14,23,30]},
{"name":"VAL","nums":[2,8,13,29,34,45]},
{"name":"JOHANNA","nums":[2,15,18,20,21,26]}
		];

    let drawResults = [];
    const tbody = document.querySelector('#lottoTable tbody');
    const resultsList = document.getElementById('resultsList');

    async function fetchMagayoResults() {
      try {
        const res = await fetch(
          "https://r.jina.ai/http://www.lotto-8.com/canada/listltoCA649.asp",
          { cache: "no-store" }
        );
        const text = await res.text();

        const lines = text.split(/\r?\n/);
        const dateLineRe = /^\s*(\d{2})\/(\d{2})\s*$/;
        const numsLineRe = /^\s*25\([A-Z]{3}\)(\d{1,2}(?:,\d{1,2}){5})\s+\d{1,2}\s*$/;

        const resultsByDate = new Map();
        const START = new Date("2025-11-22T00:00:00");
        const monthNames = [null, "January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];

        for (let i = 0; i < lines.length; i++) {
          const m = lines[i].match(dateLineRe);
          if (!m) continue;

          const dd = parseInt(m[1], 10);
          const mm = parseInt(m[2], 10);

          let j = i + 1;
          while (j < lines.length && lines[j].trim() === "") j++;

          if (j >= lines.length) continue;
          const n = lines[j].match(numsLineRe);
          if (!n) continue;

          const dateObj = new Date(2025, mm - 1, dd);
          if (isNaN(+dateObj) || dateObj < START) continue;

          const nums = n[1].split(",").map(x => parseInt(x.trim(), 10));
          if (nums.length !== 6 || nums.some(Number.isNaN)) continue;

          const dateStr = `${dd} ${monthNames[mm]} 2025`;
          resultsByDate.set(dateStr, nums);
        }

        drawResults = Array.from(resultsByDate.entries())
          .map(([date, nums]) => ({ date, nums }))
          .sort((a, b) => new Date(b.date) - new Date(a.date));

        updateResultsList();
        updateTable();
      } catch (err) {
        console.error("Error fetching results:", err);
        const li = document.createElement("li");
        li.textContent = "Unable to fetch results automatically.";
        resultsList.appendChild(li);
      }
    }

    function updateTable() {
      tbody.innerHTML = '';
      players.forEach(player => {
        const tr = document.createElement('tr');
        const nameTd = document.createElement('td');
        nameTd.textContent = player.name;
        tr.appendChild(nameTd);

        player.nums.forEach(num => {
          const td = document.createElement('td');
          td.textContent = num;
          if (drawResults.some(r => r.nums.includes(num))) td.classList.add('highlight');
          tr.appendChild(td);
        });

        tbody.appendChild(tr);
      });
    }

    function updateResultsList() {
      resultsList.innerHTML = '';
      drawResults.forEach(r => {
        const li = document.createElement('li');
        li.textContent = `${r.date}: ${r.nums.join(', ')}`;
        resultsList.appendChild(li);
      });
    }

    const canvas = document.getElementById('fireworksCanvas');
    const ctx = canvas.getContext('2d');
    let fireworks = [];

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }

    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    class Firework {
      constructor() {
        this.x = Math.random() * canvas.width;
        this.y = canvas.height;
        this.targetY = Math.random() * canvas.height / 2;
        this.color = `hsl(${Math.random() * 360}, 100%, 60%)`;
        this.speed = 2 + Math.random() * 3;
      }
      update() {
        this.y -= this.speed;
        if (this.y < this.targetY) this.explode();
      }
      explode() {
        for (let i = 0; i < 30; i++) fireworks.push(new Particle(this.x, this.y, this.color));
        this.dead = true;
      }
      draw() {
        ctx.beginPath();
        ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
        ctx.fillStyle = this.color;
        ctx.fill();
      }
    }

    class Particle {
      constructor(x, y, color) {
        this.x = x;
        this.y = y;
        this.color = color;
        this.speedX = (Math.random() - 0.5) * 6;
        this.speedY = (Math.random() - 0.5) * 6;
        this.life = 100;
      }
      update() {
        this.x += this.speedX;
        this.y += this.speedY;
        this.life--;
      }
      draw() {
        ctx.beginPath();
        ctx.arc(this.x, this.y, 2, 0, Math.PI * 2);
        ctx.fillStyle = this.color;
        ctx.fill();
      }
    }

    function animateFireworks() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      if (Math.random() < 0.05) fireworks.push(new Firework());
      fireworks.forEach((f, i) => {
        f.update(); f.draw();
        if (f.dead) fireworks.splice(i, 1);
      });
      requestAnimationFrame(animateFireworks);
    }

    animateFireworks();
    fetchMagayoResults();
  </script>
</body>
</html>
